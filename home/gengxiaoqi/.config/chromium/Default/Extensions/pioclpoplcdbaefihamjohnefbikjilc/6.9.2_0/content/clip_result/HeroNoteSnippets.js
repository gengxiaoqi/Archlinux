/*! Copyright 2009-2016 Evernote Corporation. All rights reserved. */
function HeroNoteSnippets(a,b,c,d,e){"use strict";function f(a){var b=navigator.language,c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["Jan","Feb","March","April","May","June","July","Aug","Sept","Oct","Nov","Dec"],e=new Date,f="%day %monthName %year",g="%monthName %day, %year",h="%year\u5e74%month\u6708%day\u65e5",i="%year\u5e74%monthName%day\u65e5";if(a.getMonth()===e.getMonth()&&a.getDate()===e.getDate()&&a.getFullYear()===e.getFullYear())return Browser.i18n.getMessage("Today");if(e.valueOf()-a.valueOf()<=6048e5&&e.getDay()!==a.getDay())return Browser.i18n.getMessage(c[a.getDay()]);var j=f,k=a.getDate();return b.match(/en-us/i)&&(j=g,k+=1==k||21==k||31==k?"st":2==k||22==k?"nd":3==k||23==k?"rd":"th"),b.match(/^zh/i)?j=h:b.match(/^ja/i)&&(j=i),j=j.replace(/%day/,k),j=j.replace(/%year/,a.getFullYear()),j=j.replace(/%monthName/,Browser.i18n.getMessage(d[a.getMonth()])),j=j.replace(/%month/,a.getMonth()+1)}function g(a,b,c){i[a.guid]&&(i[a.guid].addEventListener("load",function(){this.style.top=(this.height-144)/-2+"px",this.style.left=(this.width-190)/-2+"px",this.parentNode.parentNode.classList.add("hnsHero")}),i[a.guid].src=a.datauri,delete i[a.guid])}function h(g,h,j){for(var k=document.createElement("table"),l=null,m=null,n=0;n<g.length;n++){var o=document.createElement("div");o.classList.add("hnsNote"),j&&o.classList.add("hnsGrid");var p=h||0===n||1===n&&2===g.length;if(p){g[n].thumbsquare||(g[n].thumbsquare="/shard/"+g[n].shardId+"/thm/note/"+g[n].guid);var q=document.createElement("div");q.classList.add("hnsThumbContainer");var r=document.createElement("img");Browser.sendToExtension({name:"downloadThumbnail",guid:g[n].guid,inBusinessNotebook:g[n].inBusinessNotebook,size:190,type:"note",url:b+g[n].thumbsquare}),i[g[n].guid]=r,q.appendChild(r),o.appendChild(q)}var s=document.createElement("div");s.classList.add("hnsTitle"),s.innerText=g[n].title,s.title=g[n].title,o.appendChild(s);var t=document.createElement("div");t.classList.add("hnsDateUrl");var u=document.createElement("span");if(u.classList.add("hnsDate"),u.innerText=f(new Date(g[n].updated)),t.appendChild(u),g[n].attributes.sourceURL){var v=document.createElement("a");v.classList.add("hnsUrl"),v.href=g[n].attributes.sourceURL,v.target="_blank",v.innerText=g[n].attributes.sourceURL.replace(/^https?:\/\/(?:www\.)?(.*?)\/.*/,"$1"),t.appendChild(v)}o.appendChild(t);var w=document.createElement("div");if(w.classList.add("hnsSnippet"),w.innerText=g[n].snippet,o.appendChild(w),g[n].notebookName){var x=document.createElement("div");x.classList.add("hnsNotebookName"),x.innerText=g[n].notebookName,o.appendChild(x),o.classList.add("hnsHasNotebookName")}o.dataset.guid=g[n].guid,o.dataset.shardId=g[n].shardId,o.dataset.notebookType=g[n].inBusinessNotebook?"business":"personal",o.addEventListener("click",function(a){Browser.sendToExtension({name:"main_recordActivity"}),a.srcElement.classList.contains("hnsUrl")||a.srcElement.classList.contains("hnsNotebookName")||Browser.sendToExtension({name:"main_openWindow",url:GlobalUtils.getNoteURI(b,{noteGuid:this.dataset.guid,shardId:this.dataset.shardId},c,d)}),e(this.dataset.notebookType)}),o.addEventListener("mouseover",function(a){a.srcElement.classList.contains("hnsUrl")||a.srcElement.classList.contains("hnsNotebookName")||this.classList.add("hnsHover")}),o.addEventListener("mouseout",function(a){this.classList.remove("hnsHover")}),p||1===n?(m=document.createElement("td"),m.appendChild(o),(!l||l.children.length>=2)&&(l=document.createElement("tr"),k.appendChild(l)),l.appendChild(m)):m.appendChild(o)}a.appendChild(k),0===g.length&&(a.dataset.noResult=Browser.i18n.getMessage("noResult"),a.classList.add("noResults"))}var i={};this.setNotes=h,Browser.addMessageHandlers({receiveThumbnail:g}),Object.preventExtensions(this)}Object.preventExtensions(HeroNoteSnippets);