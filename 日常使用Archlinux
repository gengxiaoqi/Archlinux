网络：NetWorkManager
# 检查服务：systemctl status NetworkManager
# 启动服务：systemctl enable --now NetworkManager
# nmcli device wifi connect **** -a
# 连接 Wi-Fi（如果还没连）：执行 nmtui 开启可视化连接界面。

配置用户权限(sudo)
# 添加用户：useradd -m -G wheel -s /bin/zsh bulibuli
# 设置密码：passwd bulibuli
# 赋予sudo权限：执行visudo，找到下面这一行并删掉前面的 # 注释： %wheel ALL=(ALL:ALL) ALL

安装yay
git clone https://aur.archlinux.org/yay.git
cd yay
makepkg -si

安装显卡驱动
# 3D 图形支持 (OpenGL/Vulkan)
sudo pacman -S mesa vulkan-intel
# 视频硬件加速 (非常重要，否则 Wayland 下浏览器看视频 CPU 占用极高)
sudo pacman -S intel-media-driver libva-utils
# Intel: sudo pacman -S mesa lib32-mesa
# AMD: sudo pacman -S mesa lib32-mesa xf86-video-amdgpu
# NVIDIA: sudo pacman -S nvidia nvidia-utils

开启“早期微内核加载”(Early KMS) —— 关键步骤
# 在 Wayland 环境下，为了让系统从启动的第一秒就获得正确的屏幕分辨率，并避免进入桌面时闪黑屏，建议开启 Early KMS：
# 编辑配置文件：sudo nano /etc/mkinitcpio.conf
# 找到 MODULES=(...) 这一行，添加 i915：
# MODULES=(i915)
# 重新生成镜像：sudo mkinitcpio -P

屏幕缩放 (HiDPI)
# 如果你使用的是高分屏（如 2K/4K 笔记本），Wayland 处理缩放比 X11 优秀得多。 在 Sway 配置文件中，你可以直接指定：
vim ~/.config/sway/config
  output <输出名称> scale 1.5

浏览器硬件加速
# 在 Wayland 下使用 Chrome 或 Firefox，即使装了驱动，默认也可能不调用 GPU 解码。
# Firefox: 环境变量设置 MOZ_ENABLE_WAYLAND=1。
# Chrome/Edge: 在地址栏输入 chrome://flags，搜索 Ozone 并将 Preferred Ozone platform 设为 Wayland。

环境变量设置
# 为了让各种开发工具（如 Qt/GTK 软件）原生运行在 Wayland 上而非通过 XWayland 转换，建议在 /etc/environment 中加入：
# XDG_SESSION_TYPE=wayland
# GDK_BACKEND=wayland
# QT_QPA_PLATFORM=wayland

检查是否在 Wayland 下正确调用了 Intel 显卡？
# 安装工具：sudo pacman -S libva-utils intel-gpu-tools
# 检查硬件加速状态： 执行 vainfo。 如果看到大量类似 VAEntrypointVLD 的列表，说明你的 Intel 视频加速已就绪。
# 实时查看显卡负载： 执行 sudo intel_gpu_top。 打开网页视频或 Sway 界面时，你可以看到 Render/3D 和 Video 引擎的占用百分比。

开启显示管理器 (登录界面)
sudo pacman -S sddm
sudo systemctl enable sddm

中文环境优化
# 进入图形界面后，你需要解决中文显示和输入问题：
# 安装中文字体： sudo pacman -S wqy-microhei wqy-zenhei noto-fonts-cjk
# 安装输入法（推荐 Fcitx5）： sudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-pinyin-zhwiki fcitx5-configtool fcitx5-material-color
# fcitx5-im: 基础包组（包含核心和主要的输入模块）。
# fcitx5-chinese-addons: 包含拼音和五笔。
# fcitx5-pinyin-zhwiki: (可选) 维基百科词库，让联想词更智能。
# fcitx5-configtool: 图形化配置界面。
# 配置 Locale：将 /etc/locale.conf 改为 LANG=zh_CN.UTF-8。
sudo nvim /etc/environment
# 在文件中添加以下内容：
GTK_IM_MODULE=fcitx
QT_IM_MODULE=fcitx
XMODIFIERS=@im=fcitx
SDL_IM_MODULE=fcitx
GLFW_IM_MODULE=ibus
# 注意：在纯原生 Wayland 应用中，有些应用可能不再依赖 GTK_IM_MODULE 而是直接通过 Wayland 的输入协议，但为了兼容性，上述设置仍是必需的。
# 编辑 ~/.config/sway/config，在文件末尾添加：
exec fcitx5 -d
# -d 参数表示以守护进程 (Daemon) 模式运行。

# 如果你经常需要在 TTY 下长时间工作（比如没有图形界面的时候），建议把 终端字体 也调大一点，这样配合改好的 Ctrl 键，体验会好很多： 在 /etc/vconsole.conf 中添加：
# FONT=ter-v32b  # 需要安装 terminus-font 包，这是公认 TTY 下最好看的字体之一
# ter-v24b 的具体含义
# 这是一种专为高分辨率屏幕设计的位图字体，拆解如下：
# ter: 代表 Terminus 字体家族（这是 Linux TTY 下公认最清晰、阅读体验最好的字体之一）。
# -v: 代表字符集编码。v 通常对应 Version 或特定的 VGA/Unicode 映射。
# 24: 代表字号（Size）。在这里是 24 像素高。对于 1080p 或 2K 屏幕，24 或 28 的大小能让你看清文字，不至于眯着眼睛，最大32
# b: 代表 Bold（加粗）。控制台字体通常有 n (normal) 和 b (bold) 之分。
# 实时切换字体测试
setfont ter-v24b
setfont ter-v32b

在TTY下把Capslock换成Control键，直接修改默认 US 布局
# 如果你觉得上面的方法都太麻烦，可以直接去修改系统默认的 us 布局文件（虽然这种做法不那么“优雅”，但绝对有效）。
# 找到默认布局文件： 通常在 /usr/share/kbd/keymaps/i386/qwerty/us.map.gz。
# 解压并修改：
cd /tmp
gzip -d -c /usr/share/kbd/keymaps/i386/qwerty/us.map.gz > us_fixed.map
# 编辑 us_fixed.map： 找到 keycode 58 = Caps_Lock，改为 keycode 58 = Control。
# 替换回系统目录：
gzip us_fixed.map
sudo cp us_fixed.map.gz /usr/share/kbd/keymaps/i386/qwerty/us.map.gz
# 然后在 /etc/vconsole.conf 中保持 KEYMAP=us 即可。
# 为了确保在系统启动的最早期阶段就加载这个配置，必须更新 initramfs:
sudo mkinitcpio -P
reboot
# 针对 Sway 环境（Wayland 设置）
# 当你输入 sway 进入桌面后，Sway 会接管键盘驱动，不再理会 TTY 的设置。你需要修改 Sway 的配置文件：
# 编辑配置：nvim ~/.config/sway/config
# 添加输入规则：
# 代码段
# input "type:keyboard" {
#     xkb_options ctrl:nocaps
# }
# 如果你想让左 Ctrl 变成 Caps Lock（即交换），可以使用 ctrl:swapcaps。
# 重载配置：按下 $mod+Shift+c 立即生效。

tmux 是现代 Linux 用户的首选。它不仅能让你在 TTY 里横向、纵向分屏，还能让你在掉线或退出后，重新连接并找回之前的会话。
# 常用快捷键（默认前缀键是 Ctrl+b）：
# 水平分屏：Ctrl+b 然后按 "
# 垂直分屏：Ctrl+b 然后按 %
# 切换窗口：Ctrl+b 然后按 方向键
# 关闭当前分屏：输入 exit 或 Ctrl+d
# 调整分屏大小：按住 Ctrl+b 的同时按 方向键

安装桌面环境 (DE) 或窗口管理器 (WM)
sudo pacman -S sway foot waybar wofi

完整的 PipeWire 音频方案
# 为了在 Sway 下获得最佳体验，建议一次性装齐：
sudo pacman -S pipewire pipewire-pulse pipewire-alsa pipewire-jack wireplumber
# pipewire-pulse: 替换老旧的 PulseAudio。
# pipewire-alsa: 让只支持 ALSA 的老软件也能发声。
# wireplumber: 必装，它是 PipeWire 的“大脑”，负责自动连接你的耳机和扬声器。
# 💡 一个有用的小工具
# 装完之后，如果你想看看音频是怎么流动的（类似于连线），可以装个图形化工具： sudo pacman -S qpwgraph 在 Sway 里打开它，你能看到非常直观的音频接线图。

waybar自动隐藏，背景透明，显示信息设置,.config/waybar/config

foot背景透明,.config/foot/foot.ini

vim设置,.vimrc

设置.zshrc

安装yay,添加中国源并pacman -S yay
设置arhlinuxcn库

安装各种字体

设置锁屏，swaylock-effects
1. 安装
确保你安装的是增强版。
    Arch Linux: paru -S swaylock-effects-git
2. 高颜值配置模板
请将以下代码放入你的 ~/.config/sway/config。我为你调校了一组非常现代化的参数：
Bash
# 定义高颜值锁屏命令
set $lock_cmd swaylock \
    --screenshots \
    --clock \
    --indicator \
    --indicator-radius 100 \
    --indicator-thickness 7 \
    --effect-blur 7x5 \
    --effect-vignette 0.5:0.5 \
    --ring-color bb00cc \
    --key-hl-color 880033 \
    --text-color ffffff \
    --line-color 00000000 \
    --inside-color 00000088 \
    --separator-color 00000000 \
    --fade-in 0.2
# 快捷键锁定
bindsym $mod+l exec $lock_cmd

# 配合 swayidle 实现自动锁定
exec swayidle -w \
    timeout 300 '$lock_cmd' \
    timeout 600 'swaymsg "output * power off"' \
    resume 'swaymsg "output * power on"' \
    before-sleep '$lock_cmd'
3. 参数深度解析（你可以按需微调）
    --screenshots: 抓取当前屏幕作为背景。
    --effect-blur 7x5: 核心魔术。7 是模糊半径，5 是迭代次数。数值越大越模糊，但也越吃资源。
    --effect-vignette 0.5:0.5: 加上暗角效果，让中间的解锁圆环和时钟更突出。
    --clock: 在屏幕上显示时间。
    --indicator: 显示那个会随敲击闪烁的圆环。
    --fade-in 0.2: 增加 0.2 秒的淡入动画，避免闪烁感，显得更高级。
    颜色代码 (RGBA): 例如 00000088，最后两位 88 代表透明度。
4. 常见问题：锁屏背景变黑？
如果你执行 $lock_cmd 后背景是黑的，通常是因为 swaylock-effects 没能成功截图。
    解决方法：确保你安装了 grim（Sway 的截图工具），有些发行版的 effects 版本依赖它来获取背景。
5. 最终效果预览
当你按下 $mod+L：
    当前的桌面会瞬间模糊成毛玻璃。
    四周会稍微变暗（暗角）。
    屏幕中心出现一个精致的时钟和圆环。
    敲击键盘时，圆环会有色彩反馈。
需要我帮你把“锁定前屏幕变暗”那个预警功能也整合进这个 effects 版本里吗？
为了实现这个功能，你需要安装一个小工具 brightnessctl（用于控制亮度）。
最终集成版配置
请将以下内容替换或添加到你的 ~/.config/sway/config 中：
Bash
### --- 智能电源管理与高颜值锁屏 --- ###
# 1. 定义锁屏样式 (swaylock-effects)
set $lock_cmd swaylock \
    --screenshots \
    --clock \
    --indicator \
    --indicator-radius 100 \
    --indicator-thickness 7 \
    --effect-blur 7x5 \
    --effect-vignette 0.5:0.5 \
    --ring-color bb00cc \
    --key-hl-color 880033 \
    --text-color ffffff \
    --line-color 00000000 \
    --inside-color 00000088 \
    --separator-color 00000000 \
    --fade-in 0.3
# 2. 自动化逻辑 (swayidle)
# 注意：使用 -n 参数可以在恢复时自动还原亮度
exec swayidle -w \
    timeout 270 'brightnessctl -s set 10%' resume 'brightnessctl -r' \
    timeout 300 '$lock_cmd' \
    timeout 600 'swaymsg "output * power off"' \
    resume 'swaymsg "output * power on"' \
    before-sleep '$lock_cmd'
# 3. 手动锁定快捷键
bindsym $mod+l exec $lock_cmd
逻辑解析：
    4.5 分钟 (270s)：系统发现你没动，brightnessctl 会把亮度降到 10%。如果你这时动一下鼠标，亮度会立刻恢复（resume），避免了直接锁屏的尴尬。
    5 分钟 (300s)：如果你还没理它，系统会执行 $lock_cmd，屏幕瞬间变幻为毛玻璃时钟界面。
    10 分钟 (600s)：显示器彻底断电进入省电模式。
    合盖/休眠前：确保无论如何都会先锁定，保护隐私。
避坑小贴士：
    权限配置：brightnessctl 可能需要你加入 video 用户组才能免 sudo 运行：
    Bash
    sudo usermod -aG video $USER
    (修改组后通常需要重新登录系统才生效)
    笔记本用户：如果你是台式机且显示器不支持 DDC/CI 调光，brightnessctl 可能无效。如果无效，你可以把第 270s 的动作换成其他提醒，或者直接删掉那一行。


自动隐藏鼠标
1. 核心工具：swayidle
swayidle 是 Sway 原生的闲置管理工具。它不只是用来锁屏的，它的逻辑是：“当 [事件发生] 时，执行 [这条命令]”。
2. 实现“锁屏时强制隐藏鼠标”
通常锁屏时（如使用 swaylock），如果鼠标指针停在屏幕中间会非常碍眼。你可以在 Sway 配置文件中这样写：
Bash
exec swayidle -w \
    timeout 300 'swaymsg "seat * hide_cursor 1"' \
    resume 'swaymsg "seat * hide_cursor 5000"'
逻辑拆解：
timeout 300: 当你 300 秒（5 分钟）没动电脑时。
swaymsg "seat * hide_cursor 1": 立即执行命令，将隐藏延迟改为 1 毫秒（相当于视觉上的瞬间消失）。
resume: 当你重新移动鼠标或敲击键盘唤醒系统时。
swaymsg "seat * hide_cursor 5000": 将延迟恢复到正常的 5 秒。


多显示器设置
确保你的 ~/.config/kanshi/config 结构正确。一个典型的双屏自动切换配置应该是这样的：
代码段
# 只有笔记本屏幕时
profile {
    output eDP-1 enable mode 1920x1080 position 0,0
}
# 实验室外接 HDMI 屏幕时
profile {
    output eDP-1 enable mode 1920x1080 position 0,0
    output HDMI-A-1 enable mode 2560x1440 position 1920,0
}
自动启动：在 ~/.config/sway/config 中加入：
代码段
exec kanshi


电源键及合盖设置
通过 logind 全局配置（最推荐）
如果你希望无论是否进入 Sway，电源键的行为都保持一致（例如：按下即休眠），这是最稳妥的方法。
    编辑配置文件： 使用 sudo 权限打开 /etc/systemd/logind.conf。
    修改相关参数： 找到以下几行，取消注释（去掉 #）并修改为你想要的行为：
        HandlePowerKey=suspend （按下电源键时休眠）
        HandleLidSwitch=suspend （合上盖子时休眠）
    应用配置： 执行以下命令重启服务（注意：这可能会导致当前的登录会话短暂重连）：
    Bash
    sudo systemctl restart systemd-logind
    可选值： ignore (忽略), poweroff (关机), reboot (重启), halt (停止), suspend (待机/休眠到内存), hibernate (休眠到硬盘), lock (锁屏)。


安装clash-verge-rev-bin并设置
在 Arch Linux (Sway) 环境下，clash-verge-rev-bin 无法安装 TUN 模式通常是因为权限限制或服务模式（Service Mode）未正确配置。
由于 Sway 是 Wayland 协议，有时 GUI 触发的 root 权限请求（polkit）可能无法弹出，导致“安装服务”静默失败。你可以按照以下步骤手动修复。
方法一：手动安装服务（推荐）
这是解决“点击安装没反应”或“安装失败”最彻底的方法。
    停止应用：彻底关闭 Clash Verge Rev。
    执行安装脚本： 该软件包通常自带了安装服务的脚本，直接通过终端运行：
    sudo clash-verge-service-install
    启动并启用服务：
    sudo systemctl enable --now clash-verge-service
    重启应用：再次进入设置，你会发现“服务模式”已显示为“已安装”，此时即可开启 TUN 模式。
最简单的方法：使用 Sway 配置启动
编辑你的 Sway 配置文件 ~/.config/sway/config，在文件末尾添加一行：
代码段
# 启动 Clash Verge
exec clash-verge
如何让它“后台”启动？
Clash Verge 本身支持“启动时最小化”。
    打开 Clash Verge 界面。
    进入 Settings (设置)。
    找到 Start on Login (开机自启) 和 Start Minimized (启动时最小化) 并开启。
    这样 Sway 启动它时，它会自动进入系统托盘，而不会弹出一个大窗口挡住你。


配置 Shell 启动 Sway
自动登录后，系统会停在 TTY1 的 shell 提示符处。我们需要在 shell 的初始化文件中加入逻辑：如果是 TTY1 且没有显示环境，则启动 Sway。
根据你使用的 Shell，修改对应文件：
如果你使用 Zsh (推荐)
编辑 ~/.zprofile (或 ~/.zshrc)：
Bash
# 自动启动 Sway
if [ -z "$DISPLAY" ] && [ "$(tty)" = "/dev/tty1" ]; then
  exec sway
fi
如果你使用 Bash
编辑 ~/.bash_profile：
Bash
if [ -z "$DISPLAY" ] && [ "$(tty)" = "/dev/tty1" ]; then
  exec sway
fi
注意：使用 exec sway 而不是直接写 sway。这样当你说“退出 Sway”时，系统会直接退出登录回到 TTY，而不是停留在 shell 里，更加安全且优雅。
